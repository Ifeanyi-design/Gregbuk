{% extends "base.html" %}
{% block style %}
    .tet{
        margin-top: 200px;
    }
    .row.now{
        background-color: #007bff;
        color: white;
        padding: 5%;
        border-radius: 10px;
    }
    .row.now form{
        background-color: white;
        border: 6px solid #007bff;
        color: #007bff;
        padding: 5%;
        border-radius: 10px;
    }
    .butto{
        width: 30%;
    }
    .hero{
        height: 70vh;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        margin-top: 5%;
    }

{%endblock%}
{% block content %}
<div class="hero" style="background-image: url({{ url_for('static', filename='images/business-card.jpg') }});">

</div>

<div class="container tet my-5 pt-5">
  <h2 class="text-center mb-4">Contact Us</h2>
  <p class="text-center text-muted mb-5">Weâ€™d love to hear from you. Send us a good message!</p>

  <div class="row now">
    <!-- Form -->
    <div class="col-md-6 mb-4">
      <form method="POST" id="contactForm" novalidate>
        {{ form.hidden_tag() }}
          <div class="mb-3">
              {{ form.head.label(class="form-label") }}
              {{ form.head(class="form-control" + ( "is_invalid" if form.head.errors else "")) }}
                <div class="invalid-feedback" id="head-error"> {{ error }} </div>

          </div>

          <div class="mb-3">
                {{ form.name.label(class="form-label") }}
              {{ form.name(class="form-control" + ( "is_invalid" if form.name.errors else ""), placeholder="Enter you name here") }}
                <div class="invalid-feedback" style="font-weight: bold;" id="name-error"> {{ error }} </div>

          </div>

          <div class="mb-3">
                {{ form.email.label(class="form-label") }}
              {{ form.email(class="form-control" + ( "is_invalid" if form.email.errors else ""), placeholder="Enter your email here") }}
                <div class="invalid-feedback" style="font-weight: bold;" id="email-error"> {{ error }} </div>

          </div>

          <div class="mb-3">
                {{ form.phone.label(class="form-label") }}
              {{ form.phone(class="form-control" + ( "is_invalid" if form.phone.errors else ""), placeholder="Enter your phone number here") }}
                <div class="invalid-feedback" style="font-weight: bold;" id="phone-error"> {{ error }} </div>

          </div>

          <div class="mb-3">
                {{ form.message.label(class="form-label") }}
              {{ form.message(class="form-control" + ( "is_invalid" if form.message.errors else ""), placeholder="Enter your message here") }}
                <div class="invalid-feedback" style="font-weight: bold;" id="message-error"> {{ error }} </div>

          </div>

          {{ form.submit(class="btn butto btn-primary rounded-pill") }}
      </form>

        <div id="successMessage" style="font-weight: bold; background-color: white; padding: 3%; border-radius: 10px; text-align: center; display: none;" class="text-success mt-2"></div>
    </div>

    <!-- Contact Info -->
    <div class="col-md-6 side">
      <h5>Our Office</h5>
      <p>123 Street Name, City, Country</p>
      <p>Email: info@company.com</p>
      <p>Phone: +123 456 7890</p>
      <!-- Optional: Google Maps embed -->
      <iframe src="https://www.google.com/maps/embed?..." width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
    </div>
  </div>
</div>

{% endblock %}

{% block script %}
    <script>
        const form = document.getElementById("contactForm");
        form.addEventListener("submit", async (e) => {
        e.preventDefault();

        document.querySelectorAll(".invalid-feedback").forEach(el => el.innerText = "");

        document.querySelectorAll(".form-control").forEach(el => el.classList.remove("is-invalid"));

        document.getElementById("successMessage").innerText = "";

        const formData = new FormData(form);
        const response = await fetch("", {
        method: "POST", body: formData});
        const data = await response.json();

        if (data.success){
        document.getElementById("successMessage").style.display = "block"
        document.getElementById("successMessage").innerText = "Message Sent Successfully!";
        } else {
            for (const [field, messages] of Object.entries(data.errors)) {
                const input = document.querySelector(`[name=${field}]`);
                const errorDiv = document.getElementById(`${field}-error`);
                if (errorDiv)
                errorDiv.innerText = messages.join(", ");
                if (input)
                input.classList.add("is-invalid");
            }
        }
        });
    </script>
{% endblock %}